<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snowy Effect on Canvas</title>
</head>
<body>
<script>

    // 기본 초기화
    let initCondition = false;
    let myCanvas;
    let Context;

    // 떨어뜨릴 눈의 개수
    const snow_max = 150;
    let snow = Array()

    // 초기화

function init() {
    if (initCondition == false) {
        myCanvas = document.getElementById("MyCanvas");
        Context = myCanvas.getContext("2d");
        for ( let i = 0; i < snow_max; ++i) {
            const obj = new Object();
            obj.x = Math.random() * myCanvas.width;
            obj.y = Math.random() * myCanvas.height;
            obj.size = Math.sqrt(Math.random() * 100) + 1;
            obj.alpha = Math.random();
            snow.push(obj);
        }
        initCondition = true;
    }
}

// draw 이벤트
function onDraw() {
    if (initCondition == false) return;
    Context.fillStyle = "#100";
    Context.fillRect(0, 0, myCanvas.width - 1, myCanvas.height - 1);
    for (let i = 0; i < snow_max; ++i) {
        Context.beginPath();
        Context.moveTo(snow[i].x, snow[i].y);
        Context.fillStyle = `rgba(255, 255, 255, ${snow[i].alpha})`; // 채울 색상, 투명도
        Context.arc(
            snow[i].x, // 가로 좌표
            snow[i].y, // 세로 좌표
            snow[i].size, // 원래 크기
            0,             // 원호의 시작
            Math.PI * 2 // 원호의 끝
        );
        Context.closePath();
        Context.fill();
    }
    Context.filter = "none";
}

function Run(){
    for (let i = 0; i < snow_max; ++i) {
        snow[i].y += snow[i].size * 0.2;
        if (snow[i].y >= myCanvas.height) snow[i].y = -10;
    }
    onDraw();
}
document.addEventListener('DOMContentLoaded', () => {
    init();
    setInterval(Run, 20);
})
</script>

<canvas id="MyCanvas" width=800 height=600>
    Canvas is not supported
</canvas>
</body>
</html>